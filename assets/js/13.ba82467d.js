(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{353:function(t,a,s){"use strict";s.r(a);var e=s(42),r=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"使用-docker-运行-bot-实例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-docker-运行-bot-实例"}},[t._v("#")]),t._v(" 使用 Docker 运行 Bot 实例")]),t._v(" "),s("p",[t._v("通过 Docker 和我们封装好的镜像来部署 Bot 实例有许多好处，你不必自行安装配置程序运行环境，如 Node.js、第三方 NPM 包等，尤其是想要迁移 Bot 实例到不同环境的另一台设备上运行时，这种方式会为你节省了许多时间精力。")]),t._v(" "),s("h2",{attrs:{id:"如何在我的机器上通过-docker-部署运行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#如何在我的机器上通过-docker-部署运行"}},[t._v("#")]),t._v(" 如何在我的机器上通过 Docker 部署运行")]),t._v(" "),s("p",[t._v("在开始之前，请确保你已经安装好了 Docker。")]),t._v(" "),s("h3",{attrs:{id:"_1、拉取镜像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1、拉取镜像"}},[t._v("#")]),t._v(" 1、拉取镜像")]),t._v(" "),s("p",[t._v("我们在 Docker Hub 上发布了封装好的镜像 "),s("a",{attrs:{href:"https://hub.docker.com/r/siubeng/danmaqua-telegrambot",target:"_blank",rel:"noopener noreferrer"}},[t._v("siubeng/danmaqua-telegrambot"),s("OutboundLink")],1),t._v("，你可以通过以下命令拉取镜像的最新版：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("docker pull siubeng/danmaqua-telegrambot\n")])])]),s("h3",{attrs:{id:"_2、准备数据目录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2、准备数据目录"}},[t._v("#")]),t._v(" 2、准备数据目录")]),t._v(" "),s("p",[t._v("在运行容器之前，我们在宿主机环境创建一个文件夹，用于存放 Bot 数据（包含弹幕转发规则、管理员列表、运行日志等）。")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 在 /home/fython/data 创建一个文件夹 dmq-tgbot 准备存放 Bot 数据")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" -p /home/fython/data/dmq-tgbot\n")])])]),s("h3",{attrs:{id:"_3、部署运行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3、部署运行"}},[t._v("#")]),t._v(" 3、部署运行")]),t._v(" "),s("p",[t._v("接下来可以执行这一条命令（注：太长了所以分成多行）部署容器并运行，请注意修改命令里的参数：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("docker run -d "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --name dmq-tgbot "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -v /home/fython/data/dmq-tgbot:/usr/src/dmq-bot/data "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -e "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DMQ_BOT_TOKEN")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("你的 Bot Token"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -e "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DMQ_BOT_PROXY")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Bot API HTTP 代理"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -e "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DMQ_BOT_ADMINS")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Bot 管理员列表"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  siubeng/danmaqua-telegrambot\n")])])]),s("h4",{attrs:{id:"参数说明介绍"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参数说明介绍"}},[t._v("#")]),t._v(" 参数说明介绍")]),t._v(" "),s("ol",[s("li",[s("p",[s("code",[t._v("-d")]),t._v(" 代表执行后让容器在后台运行。")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("--name dmq-tgbot")]),t._v(" 代表容器命名为 "),s("code",[t._v("dmq-tgbot")]),t._v("，选一个好记的名字以便后续操作。")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("-v /home/fython/data/dmq-tgbot:/usr/src/dmq-bot/data")]),t._v(" 代表将宿主机的 "),s("code",[t._v("/home/fython/data/dmq-tgbot")]),t._v(" 挂载在容器中的 Bot 数据目录 "),s("code",[t._v("/usr/src/dmq-bot/data")]),t._v(" 上。")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("-e XXXX=YYYY")]),t._v(" 代表传入环境变量 "),s("code",[t._v("XXXX")]),t._v("，值设定为 "),s("code",[t._v("YYYY")]),t._v("，这里有三个需要修改的变量：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("DMQ_BOT_TOKEN")]),t._v("：从 "),s("code",[t._v("@BotFather")]),t._v(" 中获取的 Telegram Bot Token。")]),t._v(" "),s("li",[s("code",[t._v("DMQ_BOT_PROXY")]),t._v("：连接到 Telegram 服务器使用的 HTTP 代理，如果不需要请留空。例："),s("code",[t._v("DMQ_BOT_PROXY=http://127.0.0.1:8080")]),t._v("。注：如果想使用宿主机上的代理，最简单的方式是添加 "),s("code",[t._v("--network host")]),t._v(" 参数，但会带来一些副作用，具体请自学 Docker。")]),t._v(" "),s("li",[s("code",[t._v("DMQ_BOT_ADMINS")]),t._v("：允许控制 Bot 的管理员 Telegram ID 列表，并不是 username，你可以通过第三方客户端或者 ID 查询机器人获得自己的 ID，不可留空！多个 ID 间用逗号隔开。例："),s("code",[t._v("DMQ_BOT_ADMINS=12345,56789")])])])]),t._v(" "),s("li",[s("p",[s("code",[t._v("siubeng/danmaqua-telegrambot")]),t._v(" 代表使用我们封装好的镜像。")])])]),t._v(" "),s("h4",{attrs:{id:"例子"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#例子"}},[t._v("#")]),t._v(" 例子")]),t._v(" "),s("p",[t._v("假设我的 Token 是 "),s("code",[t._v("123456:AQUA")]),t._v("，不需要通过代理连接 Telegram API，管理员有两位 ID 分别是 "),s("code",[t._v("445")]),t._v(" 和 "),s("code",[t._v("148")]),t._v("，则部署容器的命令参数应修改为：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("docker run -d "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  --name dmq-tgbot "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -v /home/fython/data/dmq-tgbot:/usr/src/dmq-bot/data "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -e "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DMQ_BOT_TOKEN")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("123456")]),t._v(":AQUA "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -e "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DMQ_BOT_ADMINS")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("445,148")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  siubeng/danmaqua-telegrambot\n")])])]),s("h2",{attrs:{id:"如何在-paas-平台上部署运行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#如何在-paas-平台上部署运行"}},[t._v("#")]),t._v(" 如何在 PaaS 平台上部署运行")]),t._v(" "),s("p",[t._v("请参照具体平台如何部署 Docker 容器的教程。")])])}),[],!1,null,null,null);a.default=r.exports}}]);